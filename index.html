<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Learning Game</title>
    <script src="https://unpkg.com/jspsych@8.0.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.0.0"></script>
    <link href="https://unpkg.com/jspsych@8.0.0/css/jspsych.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@jspsych/plugin-preload@2.0.0"></script>
    <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.0.0"></script>
    <script src="https://unpkg.com/@jspsych/plugin-fullscreen@2.0.0"></script>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
      }
  
      body {
        background: linear-gradient(135deg, #cfd9df, #e2ebf0);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        width: 100%;
        overflow-x: hidden;
        color: #333;
      }
  
      .jspsych-display-element {
        max-width: 100%;
        text-align: center;
        padding: 50px;
        background: #ffffff;
        box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.1);
        border-radius: 12px;
        transition: transform 0.3s ease;
        position: relative;
        overflow: hidden;
        width: 100%;
      }
  
      .jspsych-display-element:hover {
        transform: scale(1.02);
      }
  
      .jspsych-html-keyboard-response-stimulus {
        font-size: 1.4em;
        color: #4a4a4a;
        line-height: 1.8;
        margin-bottom: 1.5em;
        text-align: center;
        width: 100%;
      }
  
      .typing-effect {
        white-space: nowrap;
        overflow: hidden;
        border-right: 2px solid black; 
        display: inline-block;
        width: 0; 
        animation: typing 5s steps(40, end) forwards, blink 0.8s step-end infinite;
      }
  
      @keyframes typing {
        from {
          width: 0;
        }
  
        to {
          width: 100%;
        }
      }
  
      @keyframes blink {
        from,
        to {
          border-color: transparent;
        }
  
        50% {
          border-color: #4a4a4a;
        }
      }
  
      .press-any-key {
        opacity: 0;
        font-weight: bold;
        margin-top: 20px;
        transition: opacity 0.5s ease;
      }
  
      .image-container {
        display: flex;
        justify-content: space-around;
        align-items: center;
        padding: 20px;
        gap: 80px;
        width: 100%;
        flex-wrap: wrap;
      }
  
      .image-container img {
        width: 300px;
        height: auto;
        border-radius: 8px;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.1);
      }
  
      .image-container img:hover {
        transform: scale(1.05);
        box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.15);
      }
  
      .timer {
        font-size: 2em;
        color: #333;
        margin-top: 10px;
      }
  
      .countdown-container {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        width: 100vw;
        position: fixed;
        top: 0;
        left: 0;
        background: rgba(0, 0, 0, 0.5);
        color: white;
        font-size: 8em;
        font-weight: bold;
        z-index: 100;
      }
      /* Fullscreen button styling */
    .jspsych-fullscreen-btn {
      display: block;
      margin: 0 auto;
      padding: 12px 30px;
      font-size: 20px;
      font-weight: 600;
      color: #ffffff;
      background: linear-gradient(135deg, #6a11cb, #2575fc);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    /* Hover effect for fullscreen button */
    .jspsych-fullscreen-btn:hover {
      transform: scale(1.05);
      box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.3);
    }

    /* Responsive design for smaller screens */
    @media (max-width: 768px) {
      .image-container img {
        width: 80%; /* Scale down images for mobile */
      }

      .jspsych-html-keyboard-response-stimulus {
        font-size: 1.2em; /* Smaller font for text */
      }

      .timer {
        font-size: 1.5em; /* Adjust timer size */
      }
    }
    </style>  
  </head>
  <body>
    <script>
      // Initialize jsPsych experiment
      var jsPsych = initJsPsych({
        override_safe_mode: true
      });
      var timeline = [];
      
      // Define Fullscreen trial
      var enter_fullscreen = {
        type: jsPsychFullscreen,
        fullscreen_mode: true,
        message: `
          <div style="font-size: 36px; line-height: 1; color: #333; text-align: center; margin-bottom: 30px;">
              This study should be taken in fullscreen mode.<br><br>
              Please press the button below to continue.
          </div>
        `,
      };
      timeline.push(enter_fullscreen);
      
      // Define Welcome trial
      var welcome = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
          <div class="jspsych-html-keyboard-response-stimulus">
            <p style="font-size: 48px;">Welcome to the experiment! ðŸ˜Š</p>
            <p style="font-size: 36px;">Press any key to begin.</p>
          </div>
        `,
      };
      timeline.push(welcome);
      
      // Define Consent Form trial
      var consent_form = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
          <div style="width: 80%; height: auto; max-height: 600px; margin: auto; overflow-y: scroll; padding: 20px; border: 1px solid #ccc; font-size: 16px; line-height: 1.6; text-align: left;">
           <p>
              You are being invited to participate in a research study titled "Strategies for Building Trust with
                  Automated Agent Systems: Examining the Impact of Communication Styles in Chatbots." This study is
                  being conducted by Dr. Trevor Bonjour from UC San Diego and graduate researchers in the Department
                  of Computational Social Science.
            </p>
            <p>
              The purpose of this study is to better understand how communication styles, such as tone, pacing, and
                  emotional expression, influence user engagement and trust when interacting with virtual conversational
                  agents. Your participation in this research should take approximately 45-60 minutes to complete.
            </p>
            <h2>What You Will Do:</h2>
            <ul>
              <li>You will interact with three virtual agents that use different communication styles. Each
              interaction will last about 10-15 minutes.</li>
              <li>After each interaction, you will complete a short survey to provide feedback about your
              experience.</li>
              <li>Your interactions will be audio-recorded for later transcription and analysis.</li>
            </ul>
            
            <h2>Confidentiality:</h2>
            <ul>
              <li>Your responses will be anonymized using a unique participant ID.</li>
              <li>Any audio recordings will be stored securely on encrypted servers.</li>
              <li>Your responses will be shared only in de-identified, aggregated form.</li>
              <li>Your data may be retained indefinitely and used for future research.</li>
            </ul>
            
            <p>If you have questions, contact Dr. Trevor Bonjour (tbonjour@ucsd.edu) or the UC San Diego IRB
            Administration (irb@ucsd.edu, 858-246-4777).</p>
          </div>
        `,
        choices: "ALL_KEYS", 
        on_finish: function(data) {
          console.log("Consent form completed");
        }
      };
      timeline.push(consent_form);

      // Talk-to Agent trial with ElevenLabs widget (only on this page)
      var talk_to_agent_widget = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
          <div style="text-align: center;">
            <h2>Talk to the Agent</h2>
            <div id="widget-container"></div>
            <p>When you're finished, press any key to continue.</p>
          </div>
        `,
        on_load: function() {
          var container = document.getElementById("widget-container");
          // Create the widget element
          var widget = document.createElement("elevenlabs-convai");
          widget.setAttribute("agent-id", "xHPpWVYMoypoMsJji7PC");
          container.appendChild(widget);
          // Create the script element for the widget
          var script = document.createElement("script");
          script.src = "https://elevenlabs.io/convai-widget/index.js";
          script.async = true;
          script.type = "text/javascript";
          container.appendChild(script);
        }
      };
      timeline.push(talk_to_agent_widget);
      
      // Define Thank You trial
      var thank_you_page = {
        type: jsPsychHtmlKeyboardResponse,
        stimulus: `
          <div style="text-align: center; font-size: 18px; line-height: 1.6;">
            <h1 style="font-size: 24px; color: #4a4a4a;">Thank You for Participating!</h1>
            <p>We greatly appreciate your participation in this study.</p>
            <p><strong>Debriefing:</strong></p>
            <p>This study aims to investigate how individuals learn associations between words and objects through exposure to varying visual and auditory stimuli.</p>
            <p>Your responses will help us better understand learning processes and may contribute to the design of future educational and cognitive models.</p>
            <p>If you have any questions about this study or your participation, please contact us:</p>
            <p>Emails:</p>
            <ul style="list-style-type: none; padding: 0;">
              <li><a href="mailto:a2park@ucsd.edu">a2park@ucsd.edu</a></li>
              <li><a href="mailto:hjunyi@ucsd.edu">hjunyi@ucsd.edu</a></li>
              <li><a href="mailto:pcui@ucsd.edu">pcui@ucsd.edu</a></li>
              <li><a href="mailto:yad014@ucsd.edu">yad014@ucsd.edu</a></li>
            </ul>
            <p>Press any key to exit.</p>
          </div>
        `,
      };
      timeline.push(thank_you_page);
      
      // Run the jsPsych experiment
      jsPsych.run(timeline);
    </script>
  </body>
</html>
